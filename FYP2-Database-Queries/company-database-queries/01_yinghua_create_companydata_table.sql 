-- FILE: 01_yinghua_create_companydata_table.sql  
-- DATE: Fri Jan 5 10:46 MYT 2018
-- AUTHOR: Chai Ying Hua 
-- VERSION: 1.0
-- DATABASE: psql (PostgreSQL) 9.5.10
-- DESCRIPTION:
--
--    1. Create companies table in company database
--
-- ========================================================

-- drop the previous table 
drop table company_rawdata; 

-- create new table for the database 
create table company_rawdata ( 
	CompanyName 		varchar(160) null default null, 
	CompanyNumber 		varchar(8) not null primary key,
	CareOf 			varchar(100) null, 
	POBox 			varchar(10) null,
	AddressLine1 		varchar(300) null,
	AddressLine2 		varchar(300) null,
	PostTown 		varchar(50) null,
	County 			varchar(50) null,
	Country 		varchar(50) null,
	PostCode 		varchar(20) null,
	CompanyCategory 	varchar(100) not null,
	CompanyStatus 		varchar(70) not null,
	CountryOfOrigin 	varchar(50) not null,
	DissolutionDate 	date null,
	IncorporationDate 	date null,
	AccountingRefDay 	int null default 0,
	AccountingRefMonth 	int null default 0,
	Account_NextDueDate 	date null default null,
	Account_LastMadeUpdate 	date null default null,
	AccountCategory 	varchar(30) null,
	Return_NextDueDate 	date null default null,
	Return_LastMadeUpDate 	date null default null,
	NumMortCharges 		int not null,
	NumMortOutstanding 	int not null,
	NumMortPartSatisfied	int not null,
	NumMortSatisfied 	int not null,
	SICCode1 		varchar(170) null,
	SICCode2 		varchar(170) null,
	SICCode3 		varchar(170) null,
	SICCode4 		varchar(170) null,
	NumGenPartners 		int not null,
	NumLimPartners 		int not null,
	URI 			varchar(47) not null,
	pn1_CONDate 		date null default null,
	pn1_CompanyName 	varchar(160) null,
	pn2_CONDate 		date null default null,
	pn2_CompanyName 	varchar(160) null,
	pn3_CONDate 		date null default null,
	pn3_CompanyName 	varchar(160) null,
	pn4_CONDate 		date null default null,
	pn4_CompanyName 	varchar(160) null,
	pn5_CONDate 		date null default null,
	pn5_CompanyName 	varchar(160) null,
	pn6_CONDate 		date null default null,
	pn6_CompanyName		varchar(160) null,
	pn7_CONDate 		date null default null,
	pn7_CompanyName 	varchar(160) null,
	pn8_CONDate 		date null default null,
	pn8_CompanyName 	varchar(160) null,
	pn9_CONDate 		date null default null,
	pn9_CompanyName 	varchar(160) null,
	pn10_CONDate 		date null default null,
	pn10_CompanyName 	varchar(160) null,
	ConfStmtNextDueDate 	date null default null,
	ConfStmtLastMadeUpDate 	date null default null
);

-- copy the content of csv into the table
\copy company_rawdata from '/home/yinghua/Documents/FYP1/FYP-data/company-data/company-data-full.csv' with header csv;

-- verify whether all data are inserted
select count(*) from company_rawdata;

-- list the structure of company_rawdata table 
\d+ company_rawdata; 


